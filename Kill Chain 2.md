 # Kill Chain 2
 ![KillChain](/img/KC-2.png "Kill Chain 2")

  ![KillChain](/img/KC2-ThreatMatrix.png "Kill Chain TheatMatrix")

  # Kill Chain 2 

## Path 1 (11, 16,
## (11, 16, 20, 21, 25)
1. Abuse SSTI
2. Use got token with Az PowerShell to find all accesible resources
3. To be able to access the keyvault request a keyvault access token,
4. request new ARM access token
5. check if we can access the keyvault and possible any secrets
6. Let's see what Azure resources the user Kathy has access to. You may like to note that Kathy's access to Azure portal using a web browser is blocked using a Condition Access Policy
7. Let's enumerate role assignments on the VM 'jumpvm':
8. So there is a group 'VM admins' that has the Virtual Machine Command Executor role on the jumpvm VM
9. Let's get some information about the VM admins group and its membership:
10. We will use the Graph API to get all the details and not Az PowerShell. So VMContributorx@defcorphq.onmicrosoft.com is added to an administrative unit 'Control Group'.
11. Let's get information and membership of this administrative unit using Azure AD module. We are using Kathy's credentials below:
12. The VM Admins group is a member of the administrative unit. Let's check for any roles scoped to this administrative unit:
13. Let's check the role using the RoleId we got above:
14. Get some more details about the user Roy: