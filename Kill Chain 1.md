 # Kill Chain 1 
 ![KillChain](/img/KC-1.jpeg "Kill Chain 1")

  ![KillChain](/img/KC1-ThreatMatrix.png "Kill Chain TheatMatrix")

  # Kill Chain 1 

## Path 1 (9,14,
1. Register multitenant Application
2. Send Phishing Link via career.app
3. Erik's access token
4. **Enumerate All users using access token**
5. Modify API permissions and send phishing link to MarkD
6. Upload malicious word file to Mark's onedrive
7. Get MarkD's access token and find objects which is owned by MarkD 
8. Mark is owner of "Automation Admins" group
9. Add Mark to this group
10. Get an ARM token and use the one for aad-graph 
11. Check for Mark to get the role for Automation Group as "Contributor" role
12. Now Mark has contributor role on automation group this means execute Runbooks!
13.  Runbook script is PowerShellTcp.ps1 
		- import-AzAutomationRunbook
		- Publish-AzAutomationRunbook
		- Start-AzAutomationRunbook
		- 



## Path 2 (10,15
1. Abuse the insecure file upload vulneranility defcorphq 
2. Use access token and client id with `Az PowerShell` . AzPowershell needs `arn` token and `aad-graph` token. Only arm token gives an error when using `Get-AzRoleAssignment`
3. Manuel API calls for know `subscription ID`
4. Manuel API calls for know `List all resources accessible for the managed identity assigned to the app service`
5. Manuel API calls for know `Let's see what actions are allowed`
6. 